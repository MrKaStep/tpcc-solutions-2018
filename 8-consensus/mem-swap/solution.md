## `[mem-swap]`

Построим консенсус для $n$ потоков с использованием `mem-swap`. Заведём ячейку `flag = true` и массив `st` из $n$ элементов, содержащих `false`.

Также заведём массив `a` из $n$ ячеек для хранения значений, предложенных потоками.

```python
def Decide(v):
    a[thread_index] = v
    mem-swap(flag, st[v])
    for i = 0 to n - 1:
        if st[i]:
            return a[i]
```

По факту, первым делом каждый поток пытается захватить флаг первенства, а затем находит того, кто это сделал (возможно, себя) и возвращает его значение.
